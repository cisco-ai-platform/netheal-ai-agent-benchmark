[
  {
    "name": "Overall Performance",
    "query": "SELECT json_extract_string(json_extract(to_json(res.participants), '$.*'), '$[0]') AS id, r.task_id AS \"Run ID\", r.snapshot_version AS \"Snapshot\", ROUND(r.summary.episodes.avg_total_reward, 2) AS \"Avg Reward\", ROUND(r.summary.episodes.avg_steps, 1) AS \"Avg Steps\", ROUND(r.summary.episodes.diagnosis_success_rate * 100, 1) AS \"Pass Rate %\", r.summary.episodes.episodes || '/' || COALESCE(r.metadata.config.num_episodes, r.summary.episodes.episodes) AS \"Completed\", r.generated_at AS \"Time\" FROM results AS res, UNNEST(res.results) AS t(r) ORDER BY r.summary.episodes.avg_total_reward DESC, r.summary.episodes.avg_steps ASC, r.generated_at DESC;"
  },
  {
    "name": "Diagnosis Accuracy",
    "query": "SELECT json_extract_string(json_extract(to_json(res.participants), '$.*'), '$[0]') AS id, r.task_id AS \"Run ID\", r.snapshot_version AS \"Snapshot\", ROUND(r.summary.episodes.diagnosis_success_rate * 100, 1) AS \"Diagnosis %\", ROUND(r.summary.episodes.fault_type_macro_f1 * 100, 1) AS \"F1 Score %\", ROUND(r.summary.episodes.location_accuracy * 100, 1) AS \"Location %\", r.summary.episodes.episodes || '/' || COALESCE(r.metadata.config.num_episodes, r.summary.episodes.episodes) AS \"Completed\" FROM results AS res, UNNEST(res.results) AS t(r) ORDER BY r.summary.episodes.diagnosis_success_rate DESC, r.summary.episodes.fault_type_macro_f1 DESC;"
  },
  {
    "name": "Efficiency Metrics",
    "query": "SELECT json_extract_string(json_extract(to_json(res.participants), '$.*'), '$[0]') AS id, r.task_id AS \"Run ID\", r.snapshot_version AS \"Snapshot\", ROUND(r.summary.episodes.avg_steps_per_device, 2) AS \"Steps/Device\", ROUND(r.summary.episodes.cost_efficiency * 100, 1) AS \"Cost Eff %\", ROUND(r.summary.episodes.tool_cost_index * 100, 1) AS \"Tool Cost %\", ROUND(r.summary.episodes.topology_coverage * 100, 1) AS \"Coverage %\", r.summary.episodes.episodes || '/' || COALESCE(r.metadata.config.num_episodes, r.summary.episodes.episodes) AS \"Completed\" FROM results AS res, UNNEST(res.results) AS t(r) ORDER BY r.summary.episodes.cost_efficiency DESC, r.summary.episodes.avg_steps_per_device ASC;"
  },
  {
    "name": "Best Per Agent",
    "query": "WITH ranked AS (SELECT json_extract_string(json_extract(to_json(res.participants), '$.*'), '$[0]') AS id, r.task_id, r.snapshot_version, r.summary.episodes.avg_total_reward AS reward, r.summary.episodes.diagnosis_success_rate AS pass_rate, r.summary.episodes.episodes AS completed, COALESCE(r.metadata.config.num_episodes, r.summary.episodes.episodes) AS attempted, r.generated_at, ROW_NUMBER() OVER (PARTITION BY json_extract_string(json_extract(to_json(res.participants), '$.*'), '$[0]') ORDER BY r.summary.episodes.avg_total_reward DESC) AS rn FROM results AS res, UNNEST(res.results) AS t(r)) SELECT id, task_id AS \"Run ID\", snapshot_version AS \"Snapshot\", ROUND(reward, 2) AS \"Avg Reward\", ROUND(pass_rate * 100, 1) AS \"Pass Rate %\", completed || '/' || attempted AS \"Completed\", generated_at AS \"Time\" FROM ranked WHERE rn = 1 ORDER BY reward DESC;"
  }
]
